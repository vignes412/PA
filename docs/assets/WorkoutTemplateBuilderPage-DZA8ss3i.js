import{j as e,c as Q,r,d as as,B as b}from"./pwa-components-Ba4t8hH-.js";import{d as Se,i as we,P as O,e as R,f as Ce,c as Ie,y as ns,n as os,w as ls,u as is,x as cs,z as re,b as ds,X as us}from"./index-DxPDKD_D.js";import{I as P,D as me,a as pe,b as xe,c as he,e as fe,d as ge}from"./dialog-DAGfj3eR.js";import{S as ms,a as ps,b as xs,c as hs,d as ve}from"./select-DaY_YNIv.js";import{L as q}from"./label-YxhKVILM.js";import{S as ae}from"./scroll-area-Bnmw-K6Z.js";import{c as fs}from"./index-PTKem-tX.js";import{C as H}from"./index-BAGpjJke.js";import{S as gs,b as je,c as be,d as V,e as G,f as Te,g as D,T as Ne}from"./table-CVBkGGpE.js";import{S as vs}from"./save-BsMv5CuY.js";import{S as js}from"./square-pen-g0gOhaH8.js";import"./db-utils-DgoSxAK8.js";import"./react-vendor-Csw2ODfV.js";import"./gapiScript-D2rOjFaT.js";function ye({className:t,shape:a="rect",pulse:o=!0,variant:n="default",...p}){return e.jsx("div",{className:Q("animate-pulse",{"rounded-md":a==="rect","rounded-full":a==="circle","rounded-lg":a==="rounded","bg-muted/70":n==="default","bg-muted/30":n==="subtle"},t),...p})}var ne="rovingFocusGroup.onEntryFocus",bs={bubbles:!1,cancelable:!0},B="RovingFocusGroup",[oe,Ee,Ts]=fs(B),[Ns,Fe]=Se(B,[Ts]),[ys,Ss]=Ns(B),De=r.forwardRef((t,a)=>e.jsx(oe.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(oe.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(ws,{...t,ref:a})})}));De.displayName=B;var ws=r.forwardRef((t,a)=>{const{__scopeRovingFocusGroup:o,orientation:n,loop:p=!1,dir:h,currentTabStopId:c,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:T,onEntryFocus:v,preventScrollOnEntryFocus:i=!1,...d}=t,j=r.useRef(null),E=as(a,j),M=Ce(h),[C,u]=Ie({prop:c,defaultProp:g??null,onChange:T,caller:B}),[N,A]=r.useState(!1),m=ns(v),f=Ee(o),$=r.useRef(!1),[_,K]=r.useState(0);return r.useEffect(()=>{const x=j.current;if(x)return x.addEventListener(ne,m),()=>x.removeEventListener(ne,m)},[m]),e.jsx(ys,{scope:o,orientation:n,dir:M,loop:p,currentTabStopId:C,onItemFocus:r.useCallback(x=>u(x),[u]),onItemShiftTab:r.useCallback(()=>A(!0),[]),onFocusableItemAdd:r.useCallback(()=>K(x=>x+1),[]),onFocusableItemRemove:r.useCallback(()=>K(x=>x-1),[]),children:e.jsx(O.div,{tabIndex:N||_===0?-1:0,"data-orientation":n,...d,ref:E,style:{outline:"none",...t.style},onMouseDown:R(t.onMouseDown,()=>{$.current=!0}),onFocus:R(t.onFocus,x=>{const k=!$.current;if(x.target===x.currentTarget&&k&&!N){const U=new CustomEvent(ne,bs);if(x.currentTarget.dispatchEvent(U),!U.defaultPrevented){const L=f().filter(y=>y.focusable),z=L.find(y=>y.active),W=L.find(y=>y.id===C),J=[z,W,...L].filter(Boolean).map(y=>y.ref.current);ke(J,i)}}$.current=!1}),onBlur:R(t.onBlur,()=>A(!1))})})}),Re="RovingFocusGroupItem",Ae=r.forwardRef((t,a)=>{const{__scopeRovingFocusGroup:o,focusable:n=!0,active:p=!1,tabStopId:h,children:c,...g}=t,T=we(),v=h||T,i=Ss(Re,o),d=i.currentTabStopId===v,j=Ee(o),{onFocusableItemAdd:E,onFocusableItemRemove:M,currentTabStopId:C}=i;return r.useEffect(()=>{if(n)return E(),()=>M()},[n,E,M]),e.jsx(oe.ItemSlot,{scope:o,id:v,focusable:n,active:p,children:e.jsx(O.span,{tabIndex:d?0:-1,"data-orientation":i.orientation,...g,ref:a,onMouseDown:R(t.onMouseDown,u=>{n?i.onItemFocus(v):u.preventDefault()}),onFocus:R(t.onFocus,()=>i.onItemFocus(v)),onKeyDown:R(t.onKeyDown,u=>{if(u.key==="Tab"&&u.shiftKey){i.onItemShiftTab();return}if(u.target!==u.currentTarget)return;const N=Es(u,i.orientation,i.dir);if(N!==void 0){if(u.metaKey||u.ctrlKey||u.altKey||u.shiftKey)return;u.preventDefault();let m=j().filter(f=>f.focusable).map(f=>f.ref.current);if(N==="last")m.reverse();else if(N==="prev"||N==="next"){N==="prev"&&m.reverse();const f=m.indexOf(u.currentTarget);m=i.loop?Fs(m,f+1):m.slice(f+1)}setTimeout(()=>ke(m))}}),children:typeof c=="function"?c({isCurrentTabStop:d,hasTabStop:C!=null}):c})})});Ae.displayName=Re;var Cs={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Is(t,a){return a!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Es(t,a,o){const n=Is(t.key,o);if(!(a==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(a==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Cs[n]}function ke(t,a=!1){const o=document.activeElement;for(const n of t)if(n===o||(n.focus({preventScroll:a}),document.activeElement!==o))return}function Fs(t,a){return t.map((o,n)=>t[(a+n)%t.length])}var Ds=De,Rs=Ae,Y="Tabs",[As,Ys]=Se(Y,[Fe]),Ge=Fe(),[ks,ce]=As(Y),Me=r.forwardRef((t,a)=>{const{__scopeTabs:o,value:n,onValueChange:p,defaultValue:h,orientation:c="horizontal",dir:g,activationMode:T="automatic",...v}=t,i=Ce(g),[d,j]=Ie({prop:n,onChange:p,defaultProp:h??"",caller:Y});return e.jsx(ks,{scope:o,baseId:we(),value:d,onValueChange:j,orientation:c,dir:i,activationMode:T,children:e.jsx(O.div,{dir:i,"data-orientation":c,...v,ref:a})})});Me.displayName=Y;var _e="TabsList",Le=r.forwardRef((t,a)=>{const{__scopeTabs:o,loop:n=!0,...p}=t,h=ce(_e,o),c=Ge(o);return e.jsx(Ds,{asChild:!0,...c,orientation:h.orientation,dir:h.dir,loop:n,children:e.jsx(O.div,{role:"tablist","aria-orientation":h.orientation,...p,ref:a})})});Le.displayName=_e;var Pe="TabsTrigger",Oe=r.forwardRef((t,a)=>{const{__scopeTabs:o,value:n,disabled:p=!1,...h}=t,c=ce(Pe,o),g=Ge(o),T=Ve(c.baseId,n),v=Be(c.baseId,n),i=n===c.value;return e.jsx(Rs,{asChild:!0,...g,focusable:!p,active:i,children:e.jsx(O.button,{type:"button",role:"tab","aria-selected":i,"aria-controls":v,"data-state":i?"active":"inactive","data-disabled":p?"":void 0,disabled:p,id:T,...h,ref:a,onMouseDown:R(t.onMouseDown,d=>{!p&&d.button===0&&d.ctrlKey===!1?c.onValueChange(n):d.preventDefault()}),onKeyDown:R(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&c.onValueChange(n)}),onFocus:R(t.onFocus,()=>{const d=c.activationMode!=="manual";!i&&!p&&d&&c.onValueChange(n)})})})});Oe.displayName=Pe;var $e="TabsContent",Ue=r.forwardRef((t,a)=>{const{__scopeTabs:o,value:n,forceMount:p,children:h,...c}=t,g=ce($e,o),T=Ve(g.baseId,n),v=Be(g.baseId,n),i=n===g.value,d=r.useRef(i);return r.useEffect(()=>{const j=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(j)},[]),e.jsx(os,{present:p||i,children:({present:j})=>e.jsx(O.div,{"data-state":i?"active":"inactive","data-orientation":g.orientation,role:"tabpanel","aria-labelledby":T,hidden:!j,id:v,tabIndex:0,...c,ref:a,style:{...t.style,animationDuration:d.current?"0s":void 0},children:j&&h})})});Ue.displayName=$e;function Ve(t,a){return`${t}-trigger-${a}`}function Be(t,a){return`${t}-content-${a}`}var Gs=Me,Ke=Le,ze=Oe,We=Ue;const Ms=Gs,qe=r.forwardRef(({className:t,...a},o)=>e.jsx(Ke,{ref:o,className:Q("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a}));qe.displayName=Ke.displayName;const le=r.forwardRef(({className:t,...a},o)=>e.jsx(ze,{ref:o,className:Q("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a}));le.displayName=ze.displayName;const ie=r.forwardRef(({className:t,...a},o)=>e.jsx(We,{ref:o,className:Q("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a}));ie.displayName=We.displayName;const Xs=()=>{const{exercises:t,exerciseGroups:a,fetchExercises:o,isLoading:n}=ls(),{templates:p,fetchTemplates:h,saveTemplate:c,deleteTemplate:g,isLoading:T}=is(),[v,i]=r.useState("build"),[d,j]=r.useState(null),[E,M]=r.useState(""),[C,u]=r.useState(""),[N,A]=r.useState(""),[m,f]=r.useState([]),[$,_]=r.useState(!1),[K,x]=r.useState(!1),[k,U]=r.useState(null),[L,z]=r.useState(!1),[W,X]=r.useState(!1),[J,y]=r.useState(!1),[He,Qe]=r.useState(""),[Ye,Xe]=r.useState("success"),[I,Z]=r.useState(!1),[S,ee]=r.useState(null);r.useEffect(()=>{o(),h()},[o,h]),r.useEffect(()=>{S&&I&&(u(S.name),A(S.description),f(S.exercises),i("build"))},[S,I]);const de=t.filter(s=>{const l=!d||s.muscleGroup===d,w=!E||s.exercise.toLowerCase().includes(E.toLowerCase())||s.muscleGroup.toLowerCase().includes(E.toLowerCase());return l&&w}),Je=s=>{const l={name:s.exercise,muscleGroup:s.muscleGroup,sets:3,reps:10,weight:0,rest:60,notes:"",difficultyLevel:s.difficultyLevel,equipmentRequired:s.equipmentRequired,targetIntensity:String(s.targetIntensity),primaryMuscleGroup:s.primaryMuscleGroup,secondaryMuscleGroup:String(s.secondaryMuscleGroup||""),exerciseDuration:s.exerciseDuration,recoveryTime:s.recoveryTime,exerciseType:s.exerciseType,caloriesBurned:String(s.caloriesBurned),exerciseProgression:s.exerciseProgression,injuryRiskLevel:s.injuryRiskLevel,exerciseLink:s.exerciseLink,imageLink:s.imageLink,relativePath:s.relatedPath};f([...m,l]),F(`${s.exercise} added to template`,"success")},Ze=s=>{const l=[...m];l.splice(s,1),f(l)},se=(s,l,w)=>{const te=[...m];te[s]={...te[s],[l]:w},f(te)},es=async()=>{if(!C.trim()){F("Please enter a template name","error");return}if(m.length===0){F("Please add at least one exercise to the template","error");return}z(!0);const s={name:C,description:N,exercises:m,createdAt:I&&S?S.createdAt:new Date().toISOString(),lastUsed:I&&(S!=null&&S.lastUsed)?S.lastUsed:""};try{const l=await c(s);l.success?(F(`Workout template ${I?"updated":"saved"} successfully`,"success"),u(""),A(""),f([]),_(!1),Z(!1),ee(null),I&&i("view")):F(`Error saving template: ${l.error}`,"error")}catch(l){F(`Error: ${l.message}`,"error")}finally{z(!1)}},ss=async()=>{if(k){X(!0);try{const s=await g(k.name);s.success?(F(`Template "${k.name}" deleted successfully`,"success"),x(!1),U(null)):F(`Error deleting template: ${s.error}`,"error")}catch(s){F(`Error: ${s.message}`,"error")}finally{X(!1)}}},ts=s=>{ee(s),Z(!0)},ue=()=>{u(""),A(""),f([]),Z(!1),ee(null),i("build")},F=(s,l="success")=>{Qe(s),Xe(l),y(!0),setTimeout(()=>{y(!1)},3e3)},rs=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return e.jsx(cs,{children:e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Workout Templates"})}),e.jsxs(Ms,{value:v,onValueChange:i,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsx(le,{value:"build",children:"Build Template"}),e.jsx(le,{value:"view",children:"View Templates"})]}),e.jsxs(ie,{value:"build",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"template-name",children:"Template Name"}),e.jsx(P,{id:"template-name",placeholder:"My Workout Template",value:C,onChange:s=>u(s.target.value),className:"mb-2"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"template-description",children:"Description (Optional)"}),e.jsx(P,{id:"template-description",placeholder:"Description of your workout template...",value:N,onChange:s=>A(s.target.value)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(q,{htmlFor:"muscle-group",children:"Filter by Muscle Group"}),e.jsxs(ms,{value:d||"",onValueChange:s=>j(s||null),children:[e.jsx(ps,{id:"muscle-group",children:e.jsx(xs,{placeholder:"All Muscle Groups"})}),e.jsxs(hs,{children:[e.jsx(ve,{value:"",children:"All Muscle Groups"}),a.map(s=>e.jsx(ve,{value:s.muscleGroup,children:s.muscleGroup},s.muscleGroup))]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(q,{htmlFor:"search",children:"Search Exercises"}),e.jsxs("div",{className:"relative",children:[e.jsx(gs,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(P,{id:"search",type:"text",placeholder:"Search by name...",className:"pl-9",value:E,onChange:s=>M(s.target.value)})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_1fr] gap-6",children:[e.jsxs(H,{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Exercise Library"}),n?e.jsx("div",{className:"space-y-2",children:Array(5).fill(0).map((s,l)=>e.jsx(ye,{className:"h-16 w-full"},l))}):e.jsx(ae,{className:"h-[500px]",children:e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(G,{children:"Exercise"}),e.jsx(G,{children:"Muscle Group"}),e.jsx(G,{children:"Action"})]})}),e.jsx(Te,{children:de.length>0?de.map((s,l)=>e.jsxs(V,{children:[e.jsx(D,{children:s.exercise}),e.jsx(D,{children:s.muscleGroup}),e.jsx(D,{children:e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>Je(s),children:e.jsx(re,{className:"h-4 w-4"})})})]},`${s.exercise}-${l}`)):e.jsx(V,{children:e.jsx(D,{colSpan:3,className:"text-center py-4",children:"No exercises found"})})})]})})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Selected Exercises"}),e.jsx(ae,{className:"h-[400px] mb-4",children:m.length>0?e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs(V,{children:[e.jsx(G,{children:"Exercise"}),e.jsx(G,{children:"Sets"}),e.jsx(G,{children:"Reps"}),e.jsx(G,{children:"Rest (s)"}),e.jsx(G,{children:"Action"})]})}),e.jsx(Te,{children:m.map((s,l)=>e.jsxs(V,{children:[e.jsx(D,{children:s.name}),e.jsx(D,{children:e.jsx(P,{type:"number",value:s.sets,min:1,className:"w-16",onChange:w=>se(l,"sets",parseInt(w.target.value)||1)})}),e.jsx(D,{children:e.jsx(P,{type:"number",value:s.reps,min:1,className:"w-16",onChange:w=>se(l,"reps",parseInt(w.target.value)||1)})}),e.jsx(D,{children:e.jsx(P,{type:"number",value:s.rest,min:0,className:"w-16",onChange:w=>se(l,"rest",parseInt(w.target.value)||0)})}),e.jsx(D,{children:e.jsx(b,{size:"sm",variant:"ghost",onClick:()=>Ze(l),children:e.jsx(Ne,{className:"h-4 w-4"})})})]},l))})]}):e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No exercises added yet. Add some from the library."})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{variant:"default",onClick:()=>_(!0),disabled:m.length===0||!C.trim(),children:[e.jsx(vs,{className:"mr-2 h-4 w-4"})," ",I?"Update":"Save"," Template"]})})]})]})]}),e.jsxs(ie,{value:"view",className:"mt-6",children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs(b,{onClick:ue,children:[e.jsx(re,{className:"mr-2 h-4 w-4"})," New Template"]})}),T?e.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((s,l)=>e.jsx(ye,{className:"h-24 w-full"},l))}):p.length===0?e.jsxs(H,{className:"p-8 text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Templates Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first workout template to get started."}),e.jsxs(b,{onClick:ue,children:[e.jsx(re,{className:"mr-2 h-4 w-4"})," Create New Template"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(s=>e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description||"No description"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>ts(s),children:e.jsx(js,{className:"h-4 w-4"})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{U(s),x(!0)},children:e.jsx(Ne,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Exercises:"})," ",e.jsx("span",{className:"font-medium",children:s.exercises.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"})," ",e.jsx("span",{className:"font-medium",children:rs(s.createdAt)})]})]}),s.exercises.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Exercises:"}),e.jsx(ae,{className:"h-32",children:e.jsxs("ul",{className:"space-y-1",children:[s.exercises.slice(0,5).map((l,w)=>e.jsxs("li",{className:"text-sm",children:[l.name," - ",l.sets,"Ã—",l.reps]},w)),s.exercises.length>5&&e.jsxs("li",{className:"text-sm text-muted-foreground",children:["+",s.exercises.length-5," more"]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(b,{size:"sm",children:[e.jsx(ds,{className:"mr-2 h-4 w-4"})," Start Workout"]})})]},s.name))})]})]}),e.jsx(me,{open:$,onOpenChange:_,children:e.jsxs(pe,{children:[e.jsxs(xe,{children:[e.jsxs(he,{children:[I?"Update":"Save"," Workout Template"]}),e.jsxs(fe,{children:["Are you sure you want to ",I?"update":"save"," this workout template?"]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Template Name:"})," ",C]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Exercises:"})," ",m.length]})]}),e.jsxs(ge,{children:[e.jsx(b,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),e.jsx(b,{onClick:es,disabled:L,children:L?"Saving...":(I?"Update":"Save")+" Template"})]})]})}),e.jsx(me,{open:K,onOpenChange:x,children:e.jsxs(pe,{children:[e.jsxs(xe,{children:[e.jsx(he,{children:"Delete Workout Template"}),e.jsx(fe,{children:"Are you sure you want to delete this template? This action cannot be undone."})]}),k&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Template Name:"})," ",k.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Exercises:"})," ",k.exercises.length]})]}),e.jsxs(ge,{children:[e.jsx(b,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:ss,disabled:W,children:W?"Deleting...":"Delete Template"})]})]})}),J&&e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 bg-background border shadow-lg rounded-md px-4 py-2 flex items-center gap-2 ${Ye==="error"?"border-destructive text-destructive":"border-primary text-primary"}`,children:[He,e.jsx("button",{onClick:()=>y(!1),className:"ml-2",children:e.jsx(us,{className:"h-4 w-4"})})]})]})})};export{Xs as default};
//# sourceMappingURL=WorkoutTemplateBuilderPage-DZA8ss3i.js.map
