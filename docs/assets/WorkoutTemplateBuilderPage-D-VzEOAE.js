import{j as e,c as De,L as Ee,v as Le,t as Ge,r as a,B as r,M as Me}from"./pwa-components-DFRzXAPN.js";import{Y as Ae,L as C,I as h,k as W,i as Ie,m as Q,n as _,o as X,p as Y,q as J,s as K,X as $e}from"./DashboardLayout-c4N3lsWj.js";import{S as We,a as Pe,b as Re,c as Fe,d as Z}from"./select-C1ZopsoU.js";import{S as P}from"./scroll-area-Coq-ol54.js";import{T as Oe,a as Be,b as ee,c as se}from"./tabs-Ckg3dhe6.js";import{C as k}from"./index-DoxOVinb.js";import{a as te,b as ae,c as g,d as m,e as le,f as d}from"./table-CzyWKN9b.js";import{S as Ue}from"./search-BZv1Nir8.js";import{T as re}from"./trash-2-D7BXSIAU.js";import{S as qe}from"./save-CCykoWoj.js";import{S as ze}from"./square-pen-Cv09M6XU.js";import"./db-utils-DgoSxAK8.js";import"./react-vendor-Csw2ODfV.js";import"./check-CiQyU1a7.js";function ie({className:D,shape:p="rect",pulse:E=!0,variant:f="default",...v}){return e.jsx("div",{className:De("animate-pulse",{"rounded-md":p==="rect","rounded-full":p==="circle","rounded-lg":p==="rounded","bg-muted/70":f==="default","bg-muted/30":f==="subtle"},D),...v})}const rs=()=>{const{exercises:D,exerciseGroups:p,fetchExercises:E,isLoading:f}=Ee(),{templates:v,fetchTemplates:R,saveTemplate:ce,deleteTemplate:ne,startWorkout:oe,isLoading:de}=Le(),me=Ge(),[ue,N]=a.useState("build"),[L,xe]=a.useState(null),[T,he]=a.useState(""),[j,b]=a.useState(""),[F,y]=a.useState(""),[o,u]=a.useState([]),[pe,S]=a.useState(!1),[je,w]=a.useState(!1),[x,O]=a.useState(null),[B,U]=a.useState(!1),[q,z]=a.useState(!1),[ge,G]=a.useState(!1),[fe,ve]=a.useState(""),[Ne,Te]=a.useState("success"),[i,M]=a.useState(!1),[l,A]=a.useState(null);a.useEffect(()=>{E(),R()},[E,R]),a.useEffect(()=>{l&&i&&(b(l.name),y(l.description),u(l.exercises),N("build"))},[l,i]);const V=D.filter(s=>{const t=!L||s.muscleGroup===L,n=!T||s.exercise.toLowerCase().includes(T.toLowerCase())||s.muscleGroup.toLowerCase().includes(T.toLowerCase());return t&&n}),be=s=>{const t={name:s.exercise,muscleGroup:s.muscleGroup,sets:3,reps:10,weight:0,rest:60,notes:"",difficultyLevel:s.difficultyLevel,equipmentRequired:s.equipmentRequired,targetIntensity:String(s.targetIntensity),primaryMuscleGroup:s.primaryMuscleGroup,secondaryMuscleGroup:String(s.secondaryMuscleGroup||""),exerciseDuration:s.exerciseDuration,recoveryTime:s.recoveryTime,exerciseType:s.exerciseType,caloriesBurned:String(s.caloriesBurned),exerciseProgression:s.exerciseProgression,injuryRiskLevel:s.injuryRiskLevel,exerciseLink:s.exerciseLink,imageLink:s.imageLink,relativePath:s.relatedPath};u([...o,t]),c(`${s.exercise} added to template`,"success")},ye=s=>{const t=[...o];t.splice(s,1),u(t)},I=(s,t,n)=>{const $=[...o];$[s]={...$[s],[t]:n},u($)},Se=async()=>{if(!j.trim()){c("Please enter a template name","error");return}if(o.length===0){c("Please add at least one exercise to the template","error");return}U(!0);const s={id:i&&l?l.id:Me(),name:j,description:F,exercises:o,createdAt:i&&l?l.createdAt:new Date().toISOString(),lastUsed:i&&(l!=null&&l.lastUsed)?l.lastUsed:""};try{const t=await ce(s);t.success?(c(`Workout template ${i?"updated":"saved"} successfully`,"success"),b(""),y(""),u([]),S(!1),M(!1),A(null),i&&N("view")):c(`Error saving template: ${t.error}`,"error")}catch(t){c(`Error: ${t.message}`,"error")}finally{U(!1)}},we=async()=>{if(x){z(!0);try{const s=await ne(x.id);s.success?(c(`Template "${x.name}" deleted successfully`,"success"),w(!1),O(null)):c(`Error deleting template: ${s.error}`,"error")}catch(s){c(`Error: ${s.message}`,"error")}finally{z(!1)}}},Ce=s=>{A(s),M(!0)},H=()=>{b(""),y(""),u([]),M(!1),A(null),N("build")},c=(s,t="success")=>{ve(s),Te(t),G(!0),setTimeout(()=>{G(!1)},3e3)},ke=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return e.jsx(Ae,{children:e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Workout Templates"})}),e.jsxs(Oe,{value:ue,onValueChange:N,className:"w-full",children:[e.jsxs(Be,{className:"grid w-full grid-cols-2",children:[e.jsx(ee,{value:"build",children:"Build Template"}),e.jsx(ee,{value:"view",children:"View Templates"})]}),e.jsxs(se,{value:"build",className:"mt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"template-name",children:"Template Name"}),e.jsx(h,{id:"template-name",placeholder:"My Workout Template",value:j,onChange:s=>b(s.target.value),className:"mb-2"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"template-description",children:"Description (Optional)"}),e.jsx(h,{id:"template-description",placeholder:"Description of your workout template...",value:F,onChange:s=>y(s.target.value)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(C,{htmlFor:"muscle-group",children:"Filter by Muscle Group"}),"                  ",e.jsxs(We,{value:L||"all",onValueChange:s=>xe(s==="all"?null:s),children:[e.jsx(Pe,{id:"muscle-group",children:e.jsx(Re,{placeholder:"All Muscle Groups"})}),"                    ",e.jsxs(Fe,{children:[e.jsx(Z,{value:"all",children:"All Muscle Groups"}),p.filter(s=>s.muscleGroup&&s.muscleGroup.trim()!=="").map(s=>e.jsx(Z,{value:s.muscleGroup,children:s.muscleGroup},s.muscleGroup))]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsx(C,{htmlFor:"search",children:"Search Exercises"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ue,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(h,{id:"search",type:"text",placeholder:"Search by name...",className:"pl-9",value:T,onChange:s=>he(s.target.value)})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_1fr] gap-6",children:[e.jsxs(k,{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Exercise Library"}),f?e.jsx("div",{className:"space-y-2",children:Array(5).fill(0).map((s,t)=>e.jsx(ie,{className:"h-16 w-full"},t))}):e.jsx(P,{className:"h-[500px]",children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(g,{children:[e.jsx(m,{children:"Action"}),e.jsx(m,{children:"Exercise"}),e.jsx(m,{children:"Muscle Group"})]})}),e.jsx(le,{children:V.length>0?V.map((s,t)=>e.jsxs(g,{children:[e.jsx(d,{children:e.jsx(r,{size:"sm",variant:"ghost",onClick:()=>be(s),children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(d,{children:s.exercise}),e.jsx(d,{children:s.muscleGroup})]},`${s.exercise}-${t}`)):e.jsx(g,{children:e.jsx(d,{colSpan:3,className:"text-center py-4",children:"No exercises found"})})})]})})]}),e.jsxs(k,{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Selected Exercises"}),e.jsx(P,{className:"h-[400px] mb-4",children:o.length>0?e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(g,{children:[e.jsx(m,{children:"Exercise"}),e.jsx(m,{children:"Sets"}),e.jsx(m,{children:"Reps"}),e.jsx(m,{children:"Rest (s)"}),e.jsx(m,{children:"Action"})]})}),e.jsx(le,{children:o.map((s,t)=>e.jsxs(g,{children:[e.jsx(d,{children:s.name}),e.jsx(d,{children:e.jsx(h,{type:"number",value:s.sets,min:1,className:"w-16",onChange:n=>I(t,"sets",parseInt(n.target.value)||1)})}),e.jsx(d,{children:e.jsx(h,{type:"number",value:s.reps,min:1,className:"w-16",onChange:n=>I(t,"reps",parseInt(n.target.value)||1)})}),e.jsx(d,{children:e.jsx(h,{type:"number",value:s.rest,min:0,className:"w-16",onChange:n=>I(t,"rest",parseInt(n.target.value)||0)})}),e.jsx(d,{children:e.jsx(r,{size:"sm",variant:"ghost",onClick:()=>ye(t),children:e.jsx(re,{className:"h-4 w-4"})})})]},t))})]}):e.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No exercises added yet. Add some from the library."})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(r,{variant:"default",onClick:()=>S(!0),disabled:o.length===0||!j.trim(),children:[e.jsx(qe,{className:"mr-2 h-4 w-4"})," ",i?"Update":"Save"," Template"]})})]})]})]}),e.jsxs(se,{value:"view",className:"mt-6",children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs(r,{onClick:H,children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," New Template"]})}),de?e.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((s,t)=>e.jsx(ie,{className:"h-24 w-full"},t))}):v.length===0?e.jsxs(k,{className:"p-8 text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Templates Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first workout template to get started."}),e.jsxs(r,{onClick:H,children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," Create New Template"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(s=>e.jsxs(k,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description||"No description"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>Ce(s),children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>{O(s),w(!0)},children:e.jsx(re,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Exercises:"})," ",e.jsx("span",{className:"font-medium",children:s.exercises.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"})," ",e.jsx("span",{className:"font-medium",children:ke(s.createdAt)})]})]}),s.exercises.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Exercises:"}),e.jsx(P,{className:"h-32",children:e.jsxs("ul",{className:"space-y-1",children:[s.exercises.slice(0,5).map((t,n)=>e.jsxs("li",{className:"text-sm",children:[t.name," - ",t.sets,"Ã—",t.reps]},n)),s.exercises.length>5&&e.jsxs("li",{className:"text-sm text-muted-foreground",children:["+",s.exercises.length-5," more"]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(r,{size:"sm",onClick:async()=>{const t=await oe(s.name);t.success?(c(`Workout started with template "${s.name}"`,"success"),me.push("/workout")):c(`Error starting workout: ${t.error}`,"error")},children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"})," Start Workout"]})})]},s.name))})]})]}),e.jsx(Q,{open:pe,onOpenChange:S,children:e.jsxs(_,{children:[e.jsxs(X,{children:[e.jsxs(Y,{children:[i?"Update":"Save"," Workout Template"]}),e.jsxs(J,{children:["Are you sure you want to ",i?"update":"save"," this workout template?"]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Template Name:"})," ",j]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Exercises:"})," ",o.length]})]}),e.jsxs(K,{children:[e.jsx(r,{variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(r,{onClick:Se,disabled:B,children:B?"Saving...":(i?"Update":"Save")+" Template"})]})]})}),e.jsx(Q,{open:je,onOpenChange:w,children:e.jsxs(_,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Delete Workout Template"}),e.jsx(J,{children:"Are you sure you want to delete this template? This action cannot be undone."})]}),x&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Template Name:"})," ",x.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Exercises:"})," ",x.exercises.length]})]}),e.jsxs(K,{children:[e.jsx(r,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:we,disabled:q,children:q?"Deleting...":"Delete Template"})]})]})}),ge&&e.jsxs("div",{className:`fixed bottom-4 right-4 z-50 bg-background border shadow-lg rounded-md px-4 py-2 flex items-center gap-2 ${Ne==="error"?"border-destructive text-destructive":"border-primary text-primary"}`,children:[fe,e.jsx("button",{onClick:()=>G(!1),className:"ml-2",children:e.jsx($e,{className:"h-4 w-4"})})]})]})})};export{rs as default};
//# sourceMappingURL=WorkoutTemplateBuilderPage-D-VzEOAE.js.map
